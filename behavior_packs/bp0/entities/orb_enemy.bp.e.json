{
	"format_version": "1.20.0",
	"minecraft:entity": {
		"description": {
			"identifier": "rwm:orb_enemy",
			"is_spawnable": true,
			"is_summonable": true,
			"is_experimental": false,
			"properties": {
				"rwm:skin":{
					"type":"int",
					"range":[0,2],
					"default": 0,
					"client_sync": true
				}
			}
		},
		"components": {
			"minecraft:type_family": {
				"family": [ "orb_enemy" ]
			},
            "minecraft:physics": {
               "has_gravity": true
            },
            "minecraft:movement":{
                "value": 0.35
            },
            "minecraft:movement.basic":{},
            "minecraft:navigation.walk": {
                "can_path_over_water": true,
                "avoid_water": true
            },
            "minecraft:jump.static": {},
            "minecraft:can_climb": {},
            "minecraft:behavior.random_stroll": {
               "priority": 6,
               "speed_multiplier": 1
            },
            "minecraft:behavior.look_at_player": {
               "priority": 7,
               "look_distance": 6,
               "probability": 0.02
            },
            "minecraft:behavior.random_look_around": {
               "priority": 7
            },
			"minecraft:health": {
				"value": 1,
				"max": 1
			},
			"minecraft:damage_sensor": {
				"triggers": [
					{
						"on_damage": {},
						"deals_damage": false
					}
				]
			},
			"minecraft:collision_box": {
				"width": 0.8,
				"height": 1.8
			},
			"minecraft:pushable": {
				"is_pushable": true,
				"is_pushable_by_piston": false
			},
            "minecraft:nameable": {
                "always_show": false
            },
            "minecraft:rideable": {
                "seat_count": 1,
                "family_types": [
                    "orb_flag"
                ],
                "pull_in_entities": false,
                "seats": [
                    {
                    "position": [ 0.0, 1.9, 0.1 ],
                    "min_rider_count": 0,
                    "max_rider_count": 0,
                    "lock_rider_rotation": 0
                    }
                ]
            } 
		},
        "component_groups": {
            "rwm:orb_enemy_hunt": {
                "minecraft:behavior.nearest_attackable_target": {
                    "priority": 1,
                    "within_radius": 50,
                    "reselect_targets": true,
                    "entity_types": [
                        {
                            "filters": {
                                "any_of": [
                                {
                                    "test": "is_family",
                                    "subject": "other",
                                    "value": "orb_flag"
                                }
                                ]
                            },
                            "max_dist": 64,
                            "must_see": false
                        }
                    ]
                },
                "minecraft:behavior.melee_attack": {
                    "priority": 1,
                    "speed_multiplier": 1.0,
                    "track_target": true,
                    "on_attack": {
                        "event": "rwm:orb_enemy_pickup"
                    }
                },
                "minecraft:attack": {
                    "damage": 0
                }
            },
            "rwm:orb_enemy_run": {
                "minecraft:behavior.avoid_mob_type": {
                    "priority": 1,
                    "entity_types": {
                        "filters":
                            { "test": "is_family", "subject" : "other", "value" :  "player"}
                    },
                    "avoid_mob_sound": "mob.piglin.retreat" 
                }
            }
        },
        
		"events": {
			"rwm:orb_enemy_hunt":{
				"set_property": {"rwm:skin":0},
                "add":{
                    "component_groups":[
                        "rwm:orb_enemy_hunt"
                    ]
                },
                "remove":{
                    "component_groups":[
                        "rwm:orb_enemy_run"
                    ]
                }
			},
            "rwm:orb_enemy_run":{
				"set_property": {"rwm:skin":1},
                "add":{
                    "component_groups":[
                        "rwm:orb_enemy_run"
                    ]
                },
                "remove":{
                    "component_groups":[
                        "rwm:orb_enemy_hunt"
                    ]
                }
			},
			"rwm:orb_enemy_pickup":{
				"queue_command": {
                    "command": "function utility/games/orb/pickup_orb"
                },
                "add":{
                    "component_groups":[
                        "rwm:orb_enemy_run"
                    ]
                },
                "remove":{
                    "component_groups":[
                        "rwm:orb_enemy_hunt"
                    ]
                }
			},
            "rwm:orb_enemy_drop":{
				"queue_command": {
                    "command": "function utility/games/orb/drop_orb"
                },
                "add":{
                    "component_groups":[
                        "rwm:orb_enemy_hunt"
                    ]
                },
                "remove":{
                    "component_groups":[
                        "rwm:orb_enemy_run"
                    ]
                }
			}
		}
	}
}